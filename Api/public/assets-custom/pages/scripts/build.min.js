var FormWizard = function () { return { init: function () { function e(e) { return e.id ? "<img class='flag' src='../../assets/global/img/flags/" + e.id.toLowerCase() + ".png'/>&nbsp;&nbsp;" + e.text : e.text } if (jQuery().bootstrapWizard) { $("#terrain_list").select2({ placeholder: "Select", allowClear: !0, formatResult: e, width: "auto", formatSelection: e, escapeMarkup: function (e) { return e } }), $("#typeMaison_list").select2({ placeholder: "Select", allowClear: !0, formatResult: e, width: "auto", formatSelection: e, escapeMarkup: function (e) { return e } }), $("#pays_list").select2({ placeholder: "Select", allowClear: !0, formatResult: e, width: "auto", formatSelection: e, escapeMarkup: function (e) { return e } }), $("#region_list").select2({ placeholder: "Select", ajax: { url: function () { return "ajax/get-region.php?idxpays=" + $("#pays_list").val() }, dataType: "json", type: "GET", processResults: function (e) { return { results: $.map(e, function (e) { return { text: e.label, id: e.idx } }) } } }, allowClear: !0, formatResult: e, width: "auto", formatSelection: e, escapeMarkup: function (e) { return e } }), $("#ville_list").select2({ placeholder: "Select", ajax: { url: function () { return "ajax/get-ville.php?idxregion=" + $("#region_list").val() }, dataType: "json", type: "GET", processResults: function (e) { return { results: $.map(e, function (e) { return { text: e.label, id: e.idx } }) } } }, allowClear: !0, formatResult: e, width: "auto", formatSelection: e, escapeMarkup: function (e) { return e } }); var t = $("#submit_form"), r = $(".alert-danger", t), i = $(".alert-success", t); t.validate({ doNotHideMessage: !0, errorElement: "span", errorClass: "help-block help-block-error", focusInvalid: !1, rules: { nom: { minlength: 5, required: !0 }, password: { minlength: 5, required: !0 }, rpassword: { minlength: 5, required: !0, equalTo: "#submit_form_password" }, terrain_list: { required: !0 }, typeMaison_list: { required: !0 }, pays_list: { required: !0 }, region_list: { required: !0 }, ville_list: { required: !0 }, terrain: { required: !0 }, typeMaison: { required: !0 }, card_name: { required: !0 }, card_number: { minlength: 16, maxlength: 16, required: !0 }, card_cvc: { digits: !0, required: !0, minlength: 3, maxlength: 4 }, card_expiry_date: { required: !0 }, "payment[]": { required: !0, minlength: 1 } }, messages: { "payment[]": { required: "Please select at least one option", minlength: jQuery.validator.format("Please select at least one option") } }, errorPlacement: function (e, t) { "gender" == t.attr("name") ? e.insertAfter("#form_gender_error") : "payment[]" == t.attr("name") ? e.insertAfter("#form_payment_error") : e.insertAfter(t) }, invalidHandler: function (e, t) { i.hide(), r.show(), App.scrollTo(r, -200) }, highlight: function (e) { $(e).closest(".form-group").removeClass("has-success").addClass("has-error") }, unhighlight: function (e) { $(e).closest(".form-group").removeClass("has-error") }, success: function (e) { "gender" == e.attr("for") || "payment[]" == e.attr("for") ? (e.closest(".form-group").removeClass("has-error").addClass("has-success"), e.remove()) : e.addClass("valid").closest(".form-group").removeClass("has-error").addClass("has-success") }, submitHandler: function (e) { i.show(), r.hide(), e[0].submit() } }); var a = function () { $("#tab2 .form-control-static", t).each(function () { var e = $('[name="' + $(this).attr("data-display") + '"]', t); if (e.is(":radio") && (e = $('[name="' + $(this).attr("data-display") + '"]:checked', t)), e.is(":text") || e.is("textarea")) $(this).html(e.val()); else if (e.is("select")) $(this).html(e.find("option:selected").text()); else if (e.is(":radio") && e.is(":checked")) $(this).html(e.attr("data-title")); else if ("payment[]" == $(this).attr("data-display")) { var r = []; $('[name="payment[]"]:checked', t).each(function () { r.push($(this).attr("data-title")) }), $(this).html(r.join("<br>")) } }) }, n = function () { $.ajax({ type: "POST", url: "ajax/build.php", data: { dejaTerrain: $("#dejaTerrain").val(), typeMaison: $("#typeMaison").val(), budget_list: $("#budget_list").val(), debutTravaux_list: $("#debutTravaux_list").val(), pays_list: $("#pays_list").val(), region_list: $("#region_list").val(), ville_list: $("#ville_list").val() }, success: function (e) { } }) }, o = function (e, t, r) { var i = t.find("li").length, o = r + 1; $(".step-title", $("#form_wizard_1")).text("Etape " + (r + 1) + " sur " + i), jQuery("li", $("#form_wizard_1")).removeClass("done"); for (var s = t.find("li"), l = 0; l < r; l++)jQuery(s[l]).addClass("done"); 1 == o ? $("#form_wizard_1").find(".button-previous").hide() : $("#form_wizard_1").find(".button-previous").show(), o >= i ? ($("#form_wizard_1").find(".button-next").hide(), $("#form_wizard_1").find(".button-submit").show(), a()) : ($("#form_wizard_1").find(".button-next").show(), $("#form_wizard_1").find(".button-submit").hide()), 2 == o && 1 == $("#dejaTerrain").val() && $("#labelBudget").text("Buget maison ?"), console.log("CURRENT TAB : " + o), 4 == o ? (n(), $("#form_wizard_1").find(".button-connect").show(), $("#form_wizard_1").find(".button-previous").hide(), $("#form_wizard_1").find(".button-next").hide(), $("#form_wizard_1").find(".button-submit").hide(), $("#btnConnect").show()) : $("#form_wizard_1").find(".button-connect").hide(), App.scrollTo($(".page-title")) }; $("#form_wizard_1").bootstrapWizard({ nextSelector: ".button-next", previousSelector: ".button-previous", onTabClick: function (e, t, r, i) { return !1 }, onNext: function (e, a, n) { return i.hide(), r.hide(), 0 != t.valid() && void o(e, a, n) }, onPrevious: function (e, t, a) { i.hide(), r.hide(), o(e, t, a) }, onTabShow: function (e, t, r) { var i = t.find("li").length, a = r + 1, n = a / i * 100; $("#form_wizard_1").find(".progress-bar").css({ width: n + "%" }) } }), $("#form_wizard_1").find(".button-previous").hide(), $("#form_wizard_1 .button-submit").click(function () { alert("Ceci est un test") }).hide(), $("#terrain_list", t).change(function () { t.validate().element($(this)) }), $("#typeMaison_list", t).change(function () { t.validate().element($(this)) }), $("#pays_list", t).change(function () { t.validate().element($(this)) }), $("#region_list", t).change(function () { t.validate().element($(this)) }) } } } }(); jQuery(document).ready(function () { FormWizard.init() });